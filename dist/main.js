!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=3,this.colorTicker=0,this.geometry=new THREE.SphereGeometry(this.size,20,20),this.material=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors}),this.sphereShape=new THREE.Mesh(this.geometry,this.material),this.sphereShape.dynamic=!0;for(var t=this.geometry.faces.length,i=0;i<t;i++){var n=this.geometry.faces[i],s=new THREE.Color(16777215),r=.36*Math.random()+.64,a=.36*Math.random()+.64,o=.36*Math.random()+.64;s.setRGB(r,a,o),n.color=s}this.geometry.elementsNeedUpdate=!0,this.sphereShape.position.y=2.5}var t,i,s;return t=e,(i=[{key:"colorSwitch",value:function(e){if(255===e)for(var t=this.geometry.faces.length,i=0;i<t;i++){var n=this.geometry.faces[i],s=new THREE.Color(16777215),r=.36*Math.random()+.64,a=.36*Math.random()+.64,o=.36*Math.random()+.64;s.setRGB(r,a,o),n.color=s}this.geometry.elementsNeedUpdate=!0}}])&&n(t.prototype,i),s&&n(t,s),e}();var r=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=new THREE.Geometry,n=new THREE.LineBasicMaterial({color:"white"}),s=-15;s<=15;s+=1)i.vertices.push(new THREE.Vector3(-15,-.04,s)),i.vertices.push(new THREE.Vector3(15,-.04,s)),i.vertices.push(new THREE.Vector3(s,-.04,-15)),i.vertices.push(new THREE.Vector3(s,-.04,15));this.line=new THREE.Line(i,n,THREE.LineSegments),t.add(this.line)};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,i,n,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.colors={red:"0xFF0000",blue:"0x0000ff",yellow:"0xffff00",green:"0x00ff00"},this.color=n,this.scene=t,this.geometry=new THREE.SphereGeometry(.5,10,10),this.material=new THREE.MeshBasicMaterial({color:this.colors[n]}),this.sphereShape=new THREE.Mesh(this.geometry,this.material),this.sphereShape.name=s,this.sphereShape.position.x=i,this.sphereShape.position.z=4,this.moveForward=this.moveForward.bind(this)}var t,i,n;return t=e,(i=[{key:"moveForward",value:function(e){this.colorSwitch(),this.sphereShape.position.z>8?this.sphereShape.position.z=4:this.sphereShape.position.z+=e}},{key:"colorSwitch",value:function(){this.sphereShape.position.z>=7?this.sphereShape.material.color.setHex("0x00FFFF"):this.sphereShape.material.color.setHex(this.colors[this.color])}}])&&a(t.prototype,i),n&&a(t,n),e}();var h=function(){var e=this;e.key1=[!1,0],e.key2=[!1,0],e.key3=[!1,0],e.key4=[!1,0],document.addEventListener("keydown",(function(t){"d"===t.key&&(e.key1[0]=!0,e.key1[1]+=1),"f"===t.key&&(e.key2[0]=!0,e.key2[1]+=1),"j"===t.key&&(e.key3[0]=!0,e.key3[1]+=1),"k"===t.key&&(e.key4[0]=!0,e.key4[1]+=1),32===t.which&&t.preventDefault()})),document.addEventListener("keyup",(function(t){"d"===t.key&&(e.key1=[!1,0]),"f"===t.key&&(e.key2=[!1,0]),"j"===t.key&&(e.key3=[!1,0]),"k"===t.key&&(e.key4=[!1,0])}))};function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new THREE.FontLoader;this.scene=t,this.titleCreate=this.titleCreate.bind(this);n.load("assets/Dream MMA_Regular.typeface.json",(function(e){i.titleCreate(e)}))}var t,i,n;return t=e,(i=[{key:"titleCreate",value:function(e){var t=new THREE.TextGeometry("vibe",{font:e,size:1,height:1,curveSegments:3}),i=[new THREE.MeshPhongMaterial({color:2527479,flatShading:!0}),new THREE.MeshPhongMaterial({color:413074})];this.titleRender=new THREE.Mesh(t,i),this.titleRender.name="title",this.titleRender.position.z=-4,this.titleRender.position.x=-2.25,this.titleRender.position.y=5,this.scene.add(this.titleRender);var n=new THREE.DirectionalLight(16777215);n.position.set(2,3,2),window.light=n,this.scene.add(n)}},{key:"zoomIn",value:function(){this.titleRender&&this.titleRender.position.z<4&&(this.titleRender.position.z+=.25)}}])&&c(t.prototype,i),n&&c(t,n),e}();function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.score=i,this.playerInput=new h,this.canvas=t,this.scene=new THREE.Scene,this.container=document.getElementsByClassName("game-container")[0],this.setCamera(),this.renderer=new THREE.WebGLRenderer({canvas:this.canvas}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.animate=this.animate.bind(this),this.introAnimate=this.introAnimate.bind(this),this.id,this.openingElements(),this.introAnimate(),window.addEventListener("resize",this.onWindowResize,!1),this.startRound=this.startRound.bind(this)}var t,i,n;return t=e,(i=[{key:"openingElements",value:function(){this.controls=new u(this.scene),this.line=new r(this.scene)}},{key:"inGameElements",value:function(){this.keyspeed=.05,this.sphere=new s,this.scene.add(this.sphere.sphereShape),this.key1=new o(this.scene,-1.5,"red","1"),this.key2=new o(this.scene,-.5,"green","2"),this.key3=new o(this.scene,.5,"blue","3"),this.key4=new o(this.scene,1.5,"yellow","4")}},{key:"onWindowResize",value:function(){this.container=document.getElementsByClassName("game-container")[0],this.renderer.setSize(this.container.clientWidth,this.container.clientHeight)}},{key:"introAnimate",value:function(){this.renderer.render(this.scene,this.camera),this.controls.zoomIn(),this.id=window.requestAnimationFrame(this.introAnimate)}},{key:"animate",value:function(){var e=this.music.fetchNewFrequencies(),t=e.maxFreq,i=e.set2Ave,n=e.set3Ave,s=e.set4Ave;if(this.sphere.colorSwitch(t),this.moveKeys(t,i,n,s),this.speedUp(),this.keyCheck(),this.renderer.render(this.scene,this.camera),this.sphere.sphereShape.rotation.x+=.01,this.sphere.sphereShape.rotation.y+=.01,this.currentSong.currentTime===this.musicDuration)return this.restartRound(),f.scoreUpdate(this.score),void document.getElementsByClassName("song-selection")[0].classList.remove("hide");this.id=window.requestAnimationFrame(this.animate)}},{key:"moveKeys",value:function(e,t,i,n){for(var s=this,r=function(r){s.scene.children.some((function(a){a.name===r.toString()?a.position.z>=8?(a.position.z=4,s.scene.remove(a)):(1===r&&s.key1.moveForward(s.keyspeed),2===r&&s.key2.moveForward(s.keyspeed),3===r&&s.key3.moveForward(s.keyspeed),4===r&&s.key4.moveForward(s.keyspeed)):(255===e&&s.scene.add(s.key1.sphereShape),t>180&&s.scene.add(s.key2.sphereShape),i>150&&i<180&&s.scene.add(s.key3.sphereShape),n>120&&n<180&&s.scene.add(s.key4.sphereShape))}))},a=1;a<5;a++)r(a)}},{key:"speedUp",value:function(){var e=parseFloat(this.music.mediaElement.currentTime.toFixed(2));this.musicMarkers[0]<=e&&(this.keyspeed+=.01,this.musicMarkers.shift())}},{key:"keyCheck",value:function(){!0===this.playerInput.key1[0]&&this.key1.sphereShape.position.z>=7.4&&this.key1.sphereShape.position.z<=7.8&&1===this.playerInput.key1[1]&&(this.score+=20,f.scoreUpdate(this.score),this.key1.sphereShape.position.z=4,this.scene.remove(this.key1.sphereShape)),!0===this.playerInput.key2[0]&&this.key2.sphereShape.position.z>=7.4&&this.key2.sphereShape.position.z<=7.8&&1===this.playerInput.key2[1]&&(this.score+=20,f.scoreUpdate(this.score),this.key2.sphereShape.position.z=4,this.scene.remove(this.key2.sphereShape)),!0===this.playerInput.key3[0]&&this.key3.sphereShape.position.z>=7.4&&this.key3.sphereShape.position.z<=7.8&&1===this.playerInput.key3[1]&&(this.score+=20,f.scoreUpdate(this.score),this.key3.sphereShape.position.z=4,this.scene.remove(this.key3.sphereShape)),!0===this.playerInput.key4[0]&&this.key4.sphereShape.position.z>=7.4&&this.key4.sphereShape.position.z<=7.8&&1===this.playerInput.key4[1]&&(this.score+=20,f.scoreUpdate(this.score),this.key4.sphereShape.position.z=4,this.scene.remove(this.key4.sphereShape))}},{key:"clearExistingKeys",value:function(){this.scene.remove(this.key1.sphereShape),this.scene.remove(this.key2.sphereShape),this.scene.remove(this.key3.sphereShape),this.scene.remove(this.key4.sphereShape)}},{key:"restartRound",value:function(){this.clearExistingKeys(),this.score=0,this.currentSong.pause(),this.currentSong.currentTime=0,this.scene.remove(this.sphere.sphereShape),this.stopAnimation()}},{key:"setCamera",value:function(){this.camera=new THREE.PerspectiveCamera(90,this.canvas.width/this.canvas.height,.1,1e3),this.camera.position.z=10,this.camera.position.y=2}},{key:"stopAnimation",value:function(){window.cancelAnimationFrame(this.id)}},{key:"startRound",value:function(){this.musicDuration=this.currentSong.duration;var e=parseFloat((this.musicDuration/4).toFixed(2));this.musicMarkers=[e,2*e,3*e],this.inGameElements(),this.animate()}},{key:"renderFrame",value:function(e){var t=this;this.music=e,this.currentSong=this.music.mediaElement,this.currentSong.addEventListener("loadedmetadata",(function(e){t.startRound()}))}}])&&l(t.prototype,i),n&&l(t,n),e}();function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listener=new THREE.AudioListener,this.audio=new THREE.Audio(this.listener),window.audio=this.audio,this.mediaElement=new Audio("assets/".concat(t)),this.mediaElement.autoplay=!1,this.audio.setMediaElementSource(this.mediaElement),this.analyser=new THREE.AudioAnalyser(this.audio,1024),window.analyser=this.analyser}var t,i,n;return t=e,(i=[{key:"fetchNewFrequencies",value:function(){this.analyser.getFrequencyData(),this.analyser.needsUpdate=!0;var e=this.analyser.data.slice(0,16),t=this.analyser.data.slice(16,32),i=this.analyser.data.slice(32,48),n=this.analyser.data.slice(48,62),s=t.reduce((function(e,t){return e+t}),0)/t.length,r=i.reduce((function(e,t){return e+t}),0)/i.length,a=n.reduce((function(e,t){return e+t}),0)/n.length;return{maxFreq:e[2],set2Ave:s,set3Ave:r,set4Ave:a}}}])&&d(t.prototype,i),n&&d(t,n),e}();function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById("canvas"),this.stopButton=document.getElementById("stop-button"),this.audio=document.getElementById("audio"),this.score=0,document.getElementById("score-value").innerText=this.score,this.visualInit(),this.createSongList(),this.gamePaused=null,this.curSongUrl=null,this.pauseGame(),this.setMenuEvents(),this.togglePause=this.togglePause.bind(this),this.playRound=this.playRound.bind(this),this.jumpToMainMenu=this.jumpToMainMenu.bind(this)}var t,i,n;return t=e,n=[{key:"scoreUpdate",value:function(e){document.getElementById("score-value").innerText=e}}],(i=[{key:"pauseGame",value:function(){var e=this;this.pauseMenu=document.getElementById("pause-menu"),document.addEventListener("keydown",(function(t){32===t.which&&e.togglePause()}))}},{key:"togglePause",value:function(){this.gamePaused?this.gamePaused&&(this.currentSong.play(),this.visualizer.animate(),this.pauseMenu.classList.toggle("hide-menu"),this.gamePaused=!1):(this.currentSong.pause(),this.visualizer.stopAnimation(),this.pauseMenu.classList.toggle("hide-menu"),this.gamePaused=!0)}},{key:"restartCurrentSong",value:function(){this.togglePause(),this.visualizer.restartRound(),this.score=0,e.scoreUpdate(this.score),this.playRound(this.curSongUrl)}},{key:"jumpToMainMenu",value:function(){this.togglePause(),this.visualizer.restartRound();var t=document.getElementsByClassName("song-selection")[0];this.score=0,e.scoreUpdate(this.score),t.classList.remove("hide")}},{key:"createSongList",value:function(){var e=this,t=document.getElementById("song-list");["Dont Wanna Know","Feel So Close","If I Lose Myself","Sunday Morning","Finesse","What Do You Mean","Starboy"].forEach((function(i){var n=document.createElement("li");n.append(i),n.onclick=function(){e.curSongUrl=i,e.playRound(i)},t.append(n)}))}},{key:"setMenuEvents",value:function(){var e=this,t=document.getElementById("resume"),i=document.getElementById("restart"),n=document.getElementById("quit");t.addEventListener("click",(function(){e.togglePause()})),i.addEventListener("click",(function(){e.restartCurrentSong()})),n.addEventListener("click",(function(){e.jumpToMainMenu()}))}},{key:"visualInit",value:function(){this.visualizer=new p(this.canvas,this.score)}},{key:"playRound",value:function(e){this.gamePaused=!1,this.music=new y(e+".mp3"),document.getElementsByClassName("song-selection")[0].classList.add("hide"),this.currentSong=this.music.mediaElement,this.currentSong.play(),this.visualizer.renderFrame(this.music)}}])&&m(t.prototype,i),n&&m(t,n),e}();i(0);window.addEventListener("DOMContentLoaded",(function(){new f}))}]);
//# sourceMappingURL=main.js.map